<!DOCTYPE html>
<html>
	<header>
		<title>Login</title>
		<link rel="stylesheet" type="text/css" href="/static/styles/style.css">
		<link href='http://fonts.googleapis.com/css?family=Roboto:300italic,400italic,400,700,300' rel='stylesheet' type='text/css'>

		<script type="text/javascript" src="/static/js/jquery-1.9.0.js"></script>
		<script type="text/javascript" src="/static/js/Ingredient.js"></script>
		<script type="text/javascript" src="/static/js/Utensil.js"></script>
		<script type="text/javascript" src="/static/js/Meal.js"></script>
		<script type="text/javascript" src="/static/js/User.js"></script>
	</header>
	<body>
		<div id="headerBar">
		<div class="wrapper headerText"><br>Welcome to Botluck!</div>
	</div>
	<div id="headerBar2">
	</div>
	<div class="wrapper">
		<br><br><br>
		<h1>Login or join here</h1>
		<br><br><br>
		<form id="login-form" action="/static/home.html">
			<input id="username-input" type="textarea" value="username"/>
			<br>
			<input id="password-input" type="textarea" value="password"/>
			<br>
		</form>
		<br>
		<br>
		<br>
		</div>
	</div>

	<div id="footerBar2"></div>
	<div id="footerBar"></div>

		
		<script type="text/javascript">
			$('#loginBttn').click(function() {
				var username = $('#username-input').val();
				var password = $('#password-input').val();
				$.ajax({
						type: "post",
						data: {"username": username, "password": password},
						url: "/verify/home.html",
						success: function(data) {
							if (data.success) {
								window.location.href = "/static/" + data.url + "?id=" + data.uid;
							}
						}
					});
			});

			// takes a username and password, and tells the server to create
			// a new user. The server returns the new user id
			var createNewUser = function(username, password, callbackfn) {
				var id;
				var wait = true;
				$.ajax({
					type: "post",
					url: "/user",
					data: {
						"username": username,
						"password": password
					},
					success: function(data) {
						if (data.success) {
							var user = new User(username, password, data.id);
							if (callbackfn !== undefined) {
								callbackfn(user);
							}
						}
					}
				});
			};


			/* Test User Creation */
			$('#createNewUserBttn').click(function() {
				var populateTestUser = function(user) {
					user.addIngredient(new Ingredient("tomatoes", 1, 1));
					user.addIngredient(new Ingredient("onions", 1, 1));
					user.addIngredient(new Ingredient("garlic", 1, 1));
					user.addIngredient(new Ingredient("potatoes", 1, 1));
					user.addIngredient(new Ingredient("pasta", 1, 1));
					user.addIngredient(new Ingredient("chicken breast", 1, 1));
					user.name = "Beyonce Knowles";
					user.addUtensil(new Utensil("spoons", 1, 1));
					user.addUtensil(new Utensil("forks", 1, 1));
					user.addUtensil(new Utensil("knives", 1, 1));
					user.karma = 10;
					user.updateServer();
				};
				createNewUser("Beyonce", "1234", populateTestUser);
			});

			/* Test User Initialize From Server */
			$('#initNewUserBttn').click(function() {
				var user = new User("", "");
				user.initFromServer(0);
			});
		</script>
	</body>
</html>